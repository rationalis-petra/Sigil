module Tui.Unicode
  ( char_update
  , unicode_input_map
  ) where

import Data.List (isPrefixOf, find)

import Data.Text.Zipper (TextZipper, insertChar, insertMany)

char_update :: Char -> [Char] -> (Maybe [Char], TextZipper String -> TextZipper String) 
char_update c cs = case filter (isPrefixOf (cs <> [c]) . fst) unicode_input_map of 
  [] -> case find ((==) cs . fst) unicode_input_map of
    Just (_, out) -> (Nothing, insertMany ([out,c]))
    _ -> (Nothing, (insertMany ((';' : cs) <> [c])))
  [(str, out)]
    | str == cs <> [c] -> (Nothing, insertChar out)
    | otherwise -> (Just (cs <> [c]), id)
  _ -> (Just (cs <> [c]), id)
  

unicode_input_map :: [([Char], Char)]
unicode_input_map =
  [ ("<" , '‚ü®')
  , (">" , '‚ü©')
  , ("(" , '‚¶Ö')
  , (")" , '‚¶Ü')
  , ("(|", '‚¶á')
  , ("|)", '‚¶à')
  , ("[" , '‚¶ó')
  , ("]" , '‚¶ò')
  , ("[-", '‚πï')
  , ("-]", '‚πñ')
  , ("[[", '‚ü¶')
  , ("]]", '‚üß')
  , ("{" , '‚¶É')
  , ("}" , '‚¶Ñ')
  , ("<.", '‚¶ë')
  , (".>", '‚¶í')
  , ("<<", '„Ää')
  , (">>", '„Äã')
  , ("-<", '‚ßº')
  , (">-", '‚ßΩ')

  -- Arrows
  , ("to" , '‚Üí')
  , ("fm" , '‚Üê')
  , ("up" , '‚Üë')
  , ("dn" , '‚Üì')
  , ("To" , '‚áí')
  , ("Fm" , '‚áê')
  , ("Up" , '‚áë')
  , ("Dn" , '‚áì')
  , ("mto", '‚Ü¶')
  , ("mfm", '‚Ü§')
  , ("le" , '‚Æú')
  , ("ri" , '‚Æû')

  -- Misc. Mathematical Symbols
  , ("O~"  , '‚ç¨')
  , ("O/"  , '‚àÖ')
  , ("ex"  , '‚àÉ')
  , ("fa"  , '‚àÄ')
  , ("in"  , '‚àà')
  , ("-."  , '¬¨')
  , ("/in" , '‚àâ')
  , ("u"   , '‚à™')
  , ("u|"  , '‚äî')
  , ("U"   , '‚ãÉ')
  , ("n"   , '‚à©')
  , ("n|"  , '‚äì')
  , ("N"   , '‚ãÇ')

  -- numeric & algebraic operations 
  , (":-", '√∑')
  , ("x" , '√ó')
  , ("*" , '‚ãÖ')
  , ("v/", '‚àö')
  , ("^" , '‚àß')
  , ("-^", '‚äº')
  , ("v" , '‚à®')
  , ("-v", '‚äΩ')
  , ("v-", '‚äª')
  , ("-.", '¬¨')

  -- equality & comparisons
  , ("~=" , '‚âÉ')
  , ("~==", '‚âÖ')
  , ("^=" , '‚âú')
  , ("/=" , '‚â†')
  , ("==" , '‚â°')
  , ("/==", '‚â¢')
  , ("?=" , '‚âü')
  , ("o=" , '‚âó')
  , (">=" , '‚â•')
  , ("!=" , '‚â†')
  , ("<=" , '‚â§')

  -- Sigil specific
  , ("A" , '‚çù')
  , ("e|", '‚ã≥')
  , ("|e", '‚ãª')
  , ("le", '‚Æú')
  , ("ri", '‚Æû') 
  , ("de", '‚âú')
  , ("rc", '·õâ')
  , ("rr", '·õØ')
  , ("ri", '·õ£')
  , ("\\", 'Ôπ®')
  , ("...", '‚Ä¶') 

  -- Subscripts
  , ("_0", '‚ÇÄ')
  , ("_1", '‚ÇÅ')
  , ("_2", '‚ÇÇ')
  , ("_3", '‚ÇÉ')
  , ("_4", '‚ÇÑ')
  , ("_5", '‚ÇÖ')
  , ("_6", '‚ÇÜ')
  , ("_7", '‚Çá')
  , ("_8", '‚Çà')
  , ("_9", '‚Çâ')
  , ("_=", '‚Çå')
  , ("_-", '‚Çã')
  , ("_+", '‚Çä')
  , ("_a", '‚Çê')
  , ("_e", '‚Çë')
  , ("_h", '‚Çï')
  , ("_i", '·µ¢')
  , ("_j", '‚±º')
  , ("_l", '‚Çó')
  , ("_m", '‚Çò')
  , ("_n", '‚Çô')
  , ("_o", '‚Çí')
  , ("_p", '‚Çö')
  , ("_r", '·µ£')
  , ("_s", '‚Çõ')
  , ("_t", '‚Çú')
  , ("_u", '·µ§')
  , ("_v", '·µ•')
  , ("_x", '‚Çì')

  -- greek
  , ("ga", 'Œ±')
  , ("gb", 'Œ≤')
  , ("gc", 'œà')
  , ("gd", 'Œ¥')
  , ("ge", 'Œµ')
  , ("gf", 'œÜ')
  , ("gg", 'Œ≥')
  , ("gh", 'Œ∑')
  , ("gi", 'Œπ')
  , ("gj", 'Œæ')
  , ("gk", 'Œ∫')
  , ("gl", 'Œª')
  , ("gm", 'Œº')
  , ("gn", 'ŒΩ')
  , ("go", 'Œø')
  , ("gp", 'œÄ')
  , ("gr", 'œÅ')
  , ("gs", 'œÉ')
  , ("gt", 'œÑ')
  , ("gu", 'Œ∏')
  , ("gv", 'œâ')
  , ("gw", 'œÇ')
  , ("gx", 'œá')
  , ("gy", 'œÖ')
  , ("gz", 'Œ∂')
  , ("gA", 'Œë')
  , ("gB", 'Œí')
  , ("gC", 'Œ®')
  , ("gD", 'Œî')
  , ("gE", 'Œï')
  , ("gF", 'Œ¶')
  , ("gG", 'Œì')
  , ("gH", 'Œó')
  , ("gI", 'Œô')
  , ("gJ", 'Œû')
  , ("gK", 'Œö')
  , ("gL", 'Œõ')
  , ("gM", 'Œú')
  , ("gN", 'Œù')
  , ("gO", 'Œü')
  , ("gP", 'Œ†')
  , ("gR", 'R')
  , ("gS", 'Œ£')
  , ("gT", 'Œ§')
  , ("gU", 'Œò')
  , ("gV", 'Œ©')
  , ("gW", 'Œ£')
  , ("gX", 'Œß')
  , ("gY", 'Œ•')
  , ("gZ", 'Œñ')

  -- Math double-struck
  , ("sA", 'ùî∏')
  , ("sB", 'ùîπ')
  , ("sC", '‚ÑÇ')
  , ("sD", 'ùîª')
  , ("sE", 'ùîº')
  , ("sF", 'ùîΩ')
  , ("sG", 'ùîæ')
  , ("sG", '‚Ñç')
  , ("sI", 'ùïÄ')
  , ("sJ", 'ùïÅ')
  , ("sK", 'ùïÇ')
  , ("sL", 'ùïÉ')
  , ("sM", 'ùïÑ')
  , ("sN", '‚Ñï')
  , ("sO", 'ùïÜ')
  , ("sP", '‚Ñô')
  , ("sQ", '‚Ñö')
  , ("sR", '‚Ñù')
  , ("sS", 'ùïä')
  , ("sT", 'ùïã')
  , ("sU", 'ùïå')
  , ("sV", 'ùïç')
  , ("sW", 'ùïé')
  , ("sX", 'ùïè')
  , ("sY", 'ùïê')
  , ("sZ", '‚Ñ§')

  ]
