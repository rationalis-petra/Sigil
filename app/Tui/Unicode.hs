module Tui.Unicode
  ( char_update
  , unicode_input_map
  ) where

import Data.List (isPrefixOf, find)

import Data.Text.Zipper (TextZipper, insertChar, insertMany)

char_update :: Char -> [Char] -> (Maybe [Char], TextZipper String -> TextZipper String) 
char_update c cs = case filter (isPrefixOf (cs <> [c]) . fst) unicode_input_map of 
  [] -> case find ((==) cs . fst) unicode_input_map of
    Just (_, out) -> (Nothing, insertMany ([out,c]))
    _ -> (Nothing, (insertMany ((';' : cs) <> [c])))
  [(str, out)]
    | str == cs <> [c] -> (Nothing, insertChar out)
    | otherwise -> (Just (cs <> [c]), id)
  _ -> (Just (cs <> [c]), id)
  

unicode_input_map :: [([Char], Char)]
unicode_input_map =
  [ ("<" , 'âŸ¨')
  , (">" , 'âŸ©')
  , ("(" , 'â¦…')
  , (")" , 'â¦†')
  , ("(|", 'â¦‡')
  , ("|)", 'â¦ˆ')
  , ("[" , 'â¦—')
  , ("]" , 'â¦˜')
  , ("[-", 'â¹•')
  , ("-]", 'â¹–')
  , ("[[", 'âŸ¦')
  , ("]]", 'âŸ§')
  , ("{" , 'â¦ƒ')
  , ("}" , 'â¦„')
  , ("<.", 'â¦‘')
  , (".>", 'â¦’')
  , ("<<", 'ã€Š')
  , (">>", 'ã€‹')
  , ("-<", 'â§¼')
  , (">-", 'â§½')

  -- Arrows
  , ("to" , 'â†’')
  , ("fm" , 'â†')
  , ("up" , 'â†‘')
  , ("dn" , 'â†“')
  , ("To" , 'â‡’')
  , ("Fm" , 'â‡')
  , ("Up" , 'â‡‘')
  , ("Dn" , 'â‡“')
  , ("mto", 'â†¦')
  , ("mfm", 'â†¤')
  , ("le" , 'â®œ')
  , ("ri" , 'â®')

  -- Misc. Mathematical Symbols
  , ("O~"  , 'â¬')
  , ("O/"  , 'âˆ…')
  , ("ex"  , 'âˆƒ')
  , ("fa"  , 'âˆ€')
  , ("in"  , 'âˆˆ')
  , ("-."  , 'Â¬')
  , ("/in" , 'âˆ‰')
  , ("u"   , 'âˆª')
  , ("u|"  , 'âŠ”')
  , ("U"   , 'â‹ƒ')
  , ("n"   , 'âˆ©')
  , ("n|"  , 'âŠ“')
  , ("N"   , 'â‹‚')

  -- numeric & algebraic operations 
  , (":-", 'Ã·')
  , ("x" , 'Ã—')
  , ("*" , 'â‹…')
  , ("v/", 'âˆš')
  , ("^" , 'âˆ§')
  , ("-^", 'âŠ¼')
  , ("v" , 'âˆ¨')
  , ("-v", 'âŠ½')
  , ("v-", 'âŠ»')
  , ("-.", 'Â¬')

  -- equality & comparisons
  , ("~=" , 'â‰ƒ')
  , ("~==", 'â‰…')
  , ("^=" , 'â‰œ')
  , ("/=" , 'â‰ ')
  , ("==" , 'â‰¡')
  , ("/==", 'â‰¢')
  , ("?=" , 'â‰Ÿ')
  , ("o=" , 'â‰—')
  , (">=" , 'â‰¥')
  , ("!=" , 'â‰ ')
  , ("<=" , 'â‰¤')

  -- Sigil specific
  , ("A" , 'â')
  , ("e|", 'â‹³')
  , ("|e", 'â‹»')
  , ("le", 'â®œ')
  , ("ri", 'â®') 
  , ("de", 'â‰œ')
  , ("rc", 'á›‰')
  , ("rr", 'á›¯')
  , ("ri", 'á›£')
  , ("\\", 'ï¹¨')
  , ("...", 'â€¦') 
  , ("_[]", 'â•')
  , ("_[]<", 'âƒ')
  , ("_[]>", 'â„')

  -- Subscripts
  , ("_0", 'â‚€')
  , ("_1", 'â‚')
  , ("_2", 'â‚‚')
  , ("_3", 'â‚ƒ')
  , ("_4", 'â‚„')
  , ("_5", 'â‚…')
  , ("_6", 'â‚†')
  , ("_7", 'â‚‡')
  , ("_8", 'â‚ˆ')
  , ("_9", 'â‚‰')
  , ("_=", 'â‚Œ')
  , ("_-", 'â‚‹')
  , ("_+", 'â‚Š')
  , ("_a", 'â‚')
  , ("_e", 'â‚‘')
  , ("_h", 'â‚•')
  , ("_i", 'áµ¢')
  , ("_j", 'â±¼')
  , ("_l", 'â‚—')
  , ("_m", 'â‚˜')
  , ("_n", 'â‚™')
  , ("_o", 'â‚’')
  , ("_p", 'â‚š')
  , ("_r", 'áµ£')
  , ("_s", 'â‚›')
  , ("_t", 'â‚œ')
  , ("_u", 'áµ¤')
  , ("_v", 'áµ¥')
  , ("_x", 'â‚“')

  -- greek
  , ("ga", 'Î±')
  , ("gb", 'Î²')
  , ("gc", 'Ïˆ')
  , ("gd", 'Î´')
  , ("ge", 'Îµ')
  , ("gf", 'Ï†')
  , ("gg", 'Î³')
  , ("gh", 'Î·')
  , ("gi", 'Î¹')
  , ("gj", 'Î¾')
  , ("gk", 'Îº')
  , ("gl", 'Î»')
  , ("gm", 'Î¼')
  , ("gn", 'Î½')
  , ("go", 'Î¿')
  , ("gp", 'Ï€')
  , ("gr", 'Ï')
  , ("gs", 'Ïƒ')
  , ("gt", 'Ï„')
  , ("gu", 'Î¸')
  , ("gv", 'Ï‰')
  , ("gw", 'Ï‚')
  , ("gx", 'Ï‡')
  , ("gy", 'Ï…')
  , ("gz", 'Î¶')
  , ("gA", 'Î‘')
  , ("gB", 'Î’')
  , ("gC", 'Î¨')
  , ("gD", 'Î”')
  , ("gE", 'Î•')
  , ("gF", 'Î¦')
  , ("gG", 'Î“')
  , ("gH", 'Î—')
  , ("gI", 'Î™')
  , ("gJ", 'Î')
  , ("gK", 'Îš')
  , ("gL", 'Î›')
  , ("gM", 'Îœ')
  , ("gN", 'Î')
  , ("gO", 'ÎŸ')
  , ("gP", 'Î ')
  , ("gR", 'R')
  , ("gS", 'Î£')
  , ("gT", 'Î¤')
  , ("gU", 'Î˜')
  , ("gV", 'Î©')
  , ("gW", 'Î£')
  , ("gX", 'Î§')
  , ("gY", 'Î¥')
  , ("gZ", 'Î–')

  -- Math double-struck
  , ("sA", 'ğ”¸')
  , ("sB", 'ğ”¹')
  , ("sC", 'â„‚')
  , ("sD", 'ğ”»')
  , ("sE", 'ğ”¼')
  , ("sF", 'ğ”½')
  , ("sG", 'ğ”¾')
  , ("sG", 'â„')
  , ("sI", 'ğ•€')
  , ("sJ", 'ğ•')
  , ("sK", 'ğ•‚')
  , ("sL", 'ğ•ƒ')
  , ("sM", 'ğ•„')
  , ("sN", 'â„•')
  , ("sO", 'ğ•†')
  , ("sP", 'â„™')
  , ("sQ", 'â„š')
  , ("sR", 'â„')
  , ("sS", 'ğ•Š')
  , ("sT", 'ğ•‹')
  , ("sU", 'ğ•Œ')
  , ("sV", 'ğ•')
  , ("sW", 'ğ•')
  , ("sX", 'ğ•')
  , ("sY", 'ğ•')
  , ("sZ", 'â„¤')

  ]
