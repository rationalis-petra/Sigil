module Tui.Unicode
  ( char_update
  , unicode_input_map
  ) where

import Data.List (isPrefixOf)

import Data.Text.Zipper (TextZipper, insertChar, insertMany)

char_update :: Char -> [Char] -> (Maybe [Char], TextZipper String -> TextZipper String) 
char_update c cs = case filter (isPrefixOf (cs <> [c]) . fst) unicode_input_map of 
  [] -> (Nothing, (insertMany ((';' : cs) <> [c])))
  [(str, out)]
    | str == cs <> [c] -> (Nothing, (insertChar out))
    | otherwise -> (Just (cs <> [c]), id)
  _ -> (Just (cs <> [c]), id)
  
unicode_input_map :: [([Char], Char)]
unicode_input_map =
  [ ("sA", 'ð”¸')
  , ("sN", 'â„•')
  , ("sU", 'ð•Œ')
  , ("sZ", 'â„¤')

  -- numeric & algebraic operations 
  , (":-", 'Ã·')
  , ("x" , 'Ã—')
  , ("*" , 'â‹…')
  , ("v/", 'âˆš')
  , ("^" , 'âˆ§')
  , ("-^", 'âŠ¼')
  , ("v" , 'âˆ¨')
  , ("-v", 'âŠ½')
  , ("v-", 'âŠ»')
  , ("-.", 'Â¬')

  -- equality & comparisons
  , ("~=" , 'â‰ƒ')
  , ("~==", 'â‰…')
  , ("^=" , 'â‰œ')
  , ("/=" , 'â‰ ')
  , ("==" , 'â‰¡')
  , ("/==", 'â‰¢')
  , ("?=" , 'â‰Ÿ')
  , ("o=" , 'â‰—')
  , (">=" , 'â‰¥')
  , ("!=" , 'â‰ ')
  , ("<=" , 'â‰¤')

  -- Sigil specific
  , ("A" , 'â')
  , ("e|", 'â‹³')
  , ("|e", 'â‹»')
  , ("le", 'â®œ')
  , ("ri", 'â®ž') 
  , ("de", 'â‰œ')
  , ("rc", 'á›‰')
  , ("rr", 'á›¯')
  , ("ri", 'á›£')

  -- arraos
  , ("to", 'â†’')
  , ("fm", 'â†')
  , ("up", 'â†‘')
  , ("dn", 'â†“')

  -- Subscripts
  , ("_0", 'â‚€')
  , ("_1", 'â‚')
  , ("_2", 'â‚‚')
  , ("_3", 'â‚ƒ')
  , ("_4", 'â‚„')
  , ("_5", 'â‚…')
  , ("_6", 'â‚†')
  , ("_7", 'â‚‡')
  , ("_8", 'â‚ˆ')
  , ("_9", 'â‚‰')
  , ("_=", 'â‚Œ')
  , ("_-", 'â‚‹')
  , ("_+", 'â‚Š')
  , ("_a", 'â‚')
  , ("_e", 'â‚‘')
  , ("_h", 'â‚•')
  , ("_i", 'áµ¢')
  , ("_j", 'â±¼')
  , ("_l", 'â‚—')
  , ("_m", 'â‚˜')
  , ("_n", 'â‚™')
  , ("_o", 'â‚’')
  , ("_p", 'â‚š')
  , ("_r", 'áµ£')
  , ("_s", 'â‚›')
  , ("_t", 'â‚œ')
  , ("_u", 'áµ¤')
  , ("_v", 'áµ¥')
  , ("_x", 'â‚“')

  -- greek
  , ("ga", 'Î±')
  , ("gb", 'Î²')
  , ("gc", 'Ïˆ')
  , ("gd", 'Î´')
  , ("ge", 'Îµ')
  , ("gf", 'Ï†')
  , ("gg", 'Î³')
  , ("gh", 'Î·')
  , ("gi", 'Î¹')
  , ("gj", 'Î¾')
  , ("gk", 'Îº')
  , ("gl", 'Î»')
  , ("gm", 'Î¼')
  , ("gn", 'Î½')
  , ("go", 'Î¿')
  , ("gp", 'Ï€')
  , ("gr", 'Ï')
  , ("gs", 'Ïƒ')
  , ("gt", 'Ï„')
  , ("gu", 'Î¸')
  , ("gv", 'Ï‰')
  , ("gw", 'Ï‚')
  , ("gx", 'Ï‡')
  , ("gy", 'Ï…')
  , ("gz", 'Î¶')
  , ("gA", 'Î‘')
  , ("gB", 'Î’')
  , ("gC", 'Î¨')
  , ("gD", 'Î”')
  , ("gE", 'Î•')
  , ("gF", 'Î¦')
  , ("gG", 'Î“')
  , ("gH", 'Î—')
  , ("gI", 'Î™')
  , ("gJ", 'Îž')
  , ("gK", 'Îš')
  , ("gL", 'Î›')
  , ("gM", 'Îœ')
  , ("gN", 'Î')
  , ("gO", 'ÎŸ')
  , ("gP", 'Î ')
  , ("gR", 'R')
  , ("gS", 'Î£')
  , ("gT", 'Î¤')
  , ("gU", 'Î˜')
  , ("gV", 'Î©')
  , ("gW", 'Î£')
  , ("gX", 'Î§')
  , ("gY", 'Î¥')
  , ("gZ", 'Î–')

  ]
