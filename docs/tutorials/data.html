<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-02-23 Thu 16:01 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tutorial: Custom Data</title>
<meta name="author" content="Connor Redfern" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
</style>
<link rel="stylesheet" href="../glyph-style.css" type="text/css"/>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Tutorial: Custom Data</h1>
<div style="text-align:right">
<p>
<a href="../index.html">Glyph</a> / <a href="index.html">Tutorials</a> / Custom Data
</p>
</div>


<div id="outline-container-orgedf4432" class="outline-2">
<h2 id="orgedf4432">Introduction</h2>
<div class="outline-text-2" id="text-orgedf4432">
<p>
So far, we have been making use of types which are built-in to Glyph. This is
fine if we only want to work with numbers, arrays and strings, but there are
often other values we want to represent in a program, such as:
</p>
<ul class="org-ul">
<li>Components in a graphical interface (buttons, paragraphs, checkboxes etc.)</li>
<li>Images</li>
<li>People</li>
<li>Network Connections</li>
<li>&#x2026;</li>
</ul>

<p>
To do this, Glyph provides several mechanisms for introducing <i>new</i> types into a
program. These are: inductive types, coinductive types and signatures. Each has
their own strengths and weaknesses, and I shall visit each in order.
</p>
</div>
</div>

<div id="outline-container-org05ab848" class="outline-2">
<h2 id="org05ab848">Inductive Types</h2>
<div class="outline-text-2" id="text-org05ab848">
</div>
<div id="outline-container-orgdf2e3ed" class="outline-3">
<h3 id="orgdf2e3ed">Introduction</h3>
<div class="outline-text-3" id="text-orgdf2e3ed">
<p>
Inductive datatypes are useful if we have a type which we want to represent some
number of distinct things. As an example, let's introduce a new type,
<i>Vehicle</i>. For now, there will be only two things which are vehicles: cars and
bikes:
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">induct</span> <span style="color: #d24b83;">Vehicle</span>
  <span style="color: #9d81ba;">(</span>bike  : <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>car   : <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
This definition roughly translates to "I am defining a new type, which is called
Vehicle. A <code>bike</code> is a vehicle. A <code>car</code> is also a vehicle.  
</p>

<p>
To creating a new vehicle is quite simple: we can type either <code>car</code> or <code>bike</code>.
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>my-vehicle : <span style="color: #d24b83;">Vehicle</span><span style="color: #807f96;">)</span>
<span style="color: #807f96;">(</span>my-vehicle &#8796; car<span style="color: #807f96;">)</span>
</pre>
</div>

<p>
In order to get useful information <i>out</i> of our vehicle, Glyph provides a
feature called <i>pattern matching</i>. As an example, I'll define 
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>main : <span style="color: #d24b83;">IO Unit</span><span style="color: #807f96;">)</span> 
<span style="color: #807f96;">(</span>main &#8796; <span style="color: #738FD7;">match</span> my-vehicle
  <span style="color: #9d81ba;">(</span>bike &#8594; put-line <span style="color: #7CF083;">"I have a bike"</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>car &#8594; put-line <span style="color: #7CF083;">"I have a car"</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
Let's dissect this: To pattern match, we use the <code>match</code> keyword, followed by
the thing we want to inspect. In this case, I want to match <i>my-vehicle</i>, so I
type that in.  Following the match, we add a series of <i>clauses</i>, which have two
parts separated by an arrow '→'.  To the left of the arrow, we have the
<i>pattern</i>. Our patterns are 'bike' and 'car'.
</p>

<p>
Matching proceeds from top to bottom, meaning that we first check if
'my-vehicle' matches 'bike'. Given we've just defined 'my-vehicle' to be 'car',
this will fail and we progress to the second pattern, 'car'. As 'my-vehicle' is
a car, the match succeeds, and so we ouptut the thing on the right, i.e. this
program will print "I have a car".
</p>

<p>
Pattern matching can be used inside a function. As an example, consider the
below function which returns the number of wheels on a particular vehicle: bikes
have 2 wheels and cars have 4.
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>wheels : <span style="color: #d24b83;">Vehicle</span> &#8594; &#8469;<span style="color: #807f96;">)</span> 
<span style="color: #807f96;">(</span>wheels vehicle &#8796; <span style="color: #738FD7;">match</span> vehicle
  <span style="color: #9d81ba;">(</span>bike &#8594; <span style="color: #cea2ca;">2</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>car &#8594; <span style="color: #cea2ca;">4</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5591fa4" class="outline-3">
<h3 id="org5591fa4">Carrying Data</h3>
<div class="outline-text-3" id="text-org5591fa4">
<p>
Suppose we want to add a new vehicle - a truck. This is relatively simply
simple, as all we need to do is return to the original 'Vehicle' definition and
add 'truck':
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">induct</span> <span style="color: #d24b83;">Vehicle</span>
  <span style="color: #9d81ba;">(</span>bike  : <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>car   : <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>truck : <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
But there is a slight problem: when updating the wheels function, we need to
decide how many wheels a truck has. This can vary depending on the truck, how
many trailers it has etc. There is no easy answer.
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>wheels : <span style="color: #d24b83;">Vehicle</span> &#8594; &#8469;<span style="color: #807f96;">)</span> 
<span style="color: #807f96;">(</span>wheels vehicle &#8796; <span style="color: #738FD7;">match</span> vehicle
  <span style="color: #9d81ba;">(</span>bike &#8594; <span style="color: #cea2ca;">2</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>car &#8594; <span style="color: #cea2ca;">4</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>truck &#8594; ??<span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
One way of solving this problem is by <i>telling</i> each truck how many wheels it
has. We do this by modifying the vehicle definition so that <code>truck</code> takes as
input a number, representing how many wheels it has
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">induct</span> <span style="color: #d24b83;">Vehicle</span>
  <span style="color: #9d81ba;">(</span>bike  : <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>car   : <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>truck : &#8469; &#8594; <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
Now, in order to make a truck, we need to provide it with a wheel count: 
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>my-vehicle &#8796; truck <span style="color: #cea2ca;">6</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
The wheels function will also need modifying - the truck pattern can now capture
the number of wheels into a fresh variable, which we'll call <code>n</code>.
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>wheels : <span style="color: #d24b83;">Vehicle</span> &#8594; &#8469;<span style="color: #807f96;">)</span> 
<span style="color: #807f96;">(</span>wheels vehicle &#8796; <span style="color: #738FD7;">match</span> vehicle
  <span style="color: #9d81ba;">(</span>bike &#8594; <span style="color: #cea2ca;">2</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>car &#8594; <span style="color: #cea2ca;">4</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>truck n &#8594; n<span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
We can further increase the complexity of the Vehicle type. For example, many
cars will carry a spare tire, which we want to count via the <code>wheels</code>
function. To do so, we can represent whether or not there is a spare via a
boolean:
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">induct</span> <span style="color: #d24b83;">Vehicle</span>
  <span style="color: #9d81ba;">(</span>bike  : <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>car   : <span style="color: #d24b83;">Bool</span> &#8594; <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>truck : &#8469; &#8594; <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
So, a car with a spare tire is <code>car true</code> and a car without is <code>car
false</code>. Then, the wheels function becomes:
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>wheels : <span style="color: #d24b83;">Vehicle</span> &#8594; &#8469;<span style="color: #807f96;">)</span> 
<span style="color: #807f96;">(</span>wheels vehicle &#8796; <span style="color: #738FD7;">match</span> vehicle
  <span style="color: #9d81ba;">(</span>bike &#8594; <span style="color: #cea2ca;">2</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>car spare &#8594; <span style="color: #738FD7;">if</span> spare <span style="color: #cea2ca;">5</span> <span style="color: #cea2ca;">4</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>truck n &#8594; n<span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
This can be a lot to digest, so I recommend you take a break and do some
[exercises] if you haven't already, to let this information settle in.
</p>
</div>
</div>

<div id="outline-container-org9da14f0" class="outline-3">
<h3 id="org9da14f0">Recursive Types</h3>
<div class="outline-text-3" id="text-org9da14f0">
</div>
<div id="outline-container-orga220e5e" class="outline-4">
<h4 id="orga220e5e">Introduction</h4>
<div class="outline-text-4" id="text-orga220e5e">
<p>
You're back? already? Good! Our next addition to the <code>vehicle</code> type will be a
Barge. Barges can carry cargo, and some even carry cars, bikes and other
vehicles! The barge we will be adding is one which can do this, so we'll provide
it with an array of vehicles, representing its' cargo:
</p>


<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">induct</span> <span style="color: #d24b83;">Vehicle</span>
  <span style="color: #9d81ba;">(</span>bike  : <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>car   : <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>truck : &#8469; &#8594; <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>barge : <span style="color: #d24b83;">Array Vehicle</span> &#8594; <span style="color: #d24b83;">Vehicle</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
Here's something strange: how many wheels does a barge have? We might be tempted
to say zero, but a barge can have wheels! I'll define the number of <code>wheels</code> on
a barge to be sum of all wheels on its' cargo. This means that when calculating
the <code>wheels</code> on a barge, we need to make use of the <code>wheels</code> function, like so:
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>wheels : <span style="color: #d24b83;">Vehicle</span> &#8594; &#8469;<span style="color: #807f96;">)</span> 
<span style="color: #807f96;">(</span>wheels vehicle &#8796; <span style="color: #738FD7;">match</span> vehicle
  <span style="color: #9d81ba;">(</span>bike &#8594; <span style="color: #cea2ca;">2</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>car &#8594; <span style="color: #cea2ca;">4</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>truck n &#8594; n<span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>barge cargo &#8594; sum <span style="color: #4d9391;">(</span>map wheels cargo<span style="color: #4d9391;">)</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
This means that the definition for <code>wheels</code> itself makes use of <code>wheels</code>. This
is perfectly fine in Glyph, and we say that a function defined like this is
<i>recursive</i>. To see how this works, imagine evaluating the expression
<code>wheels (barge ⟨car bike⟩)</code>: 
</p>

<ul class="org-ul">
<li>First, we apply the wheels function to the barge, which gives:</li>
</ul>
<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #738FD7;">match</span> <span style="color: #807f96;">(</span>barge <span style="color: #9d81ba;">&#10216;</span>car bike<span style="color: #9d81ba;">&#10217;</span><span style="color: #807f96;">)</span>
  <span style="color: #807f96;">(</span>bike &#8594; <span style="color: #cea2ca;">2</span><span style="color: #807f96;">)</span>
  <span style="color: #807f96;">(</span>car &#8594; <span style="color: #cea2ca;">4</span><span style="color: #807f96;">)</span>
  <span style="color: #807f96;">(</span>truck n &#8594; n<span style="color: #807f96;">)</span>
  <span style="color: #807f96;">(</span>barge cargo &#8594; sum <span style="color: #9d81ba;">(</span>map wheels cargo<span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>
<ul class="org-ul">
<li>Second, we perform the <i>match</i>, meaning we get the last pattern, and
substitute <i>cargo</i> for the barge's cargo, <code>⟨car bike⟩</code>, yielding</li>
</ul>
<div class="org-src-container">
<pre class="src src-glyph">sum <span style="color: #807f96;">(</span>map wheels <span style="color: #9d81ba;">&#10216;</span>car bike<span style="color: #9d81ba;">&#10217;</span><span style="color: #807f96;">)</span>
</pre>
</div>
<ul class="org-ul">
<li>Now, we go to the <i>map</i>, which applies <i>wheels</i> to each element of the array,
i.e. we have</li>
</ul>
<div class="org-src-container">
<pre class="src src-glyph">sum <span style="color: #807f96;">&#10216;</span><span style="color: #9d81ba;">(</span>wheels car<span style="color: #9d81ba;">)</span> <span style="color: #9d81ba;">(</span>wheels bike<span style="color: #9d81ba;">)</span><span style="color: #807f96;">&#10217;</span>
</pre>
</div>
<ul class="org-ul">
<li>We know that <code>(wheels car)</code> is 4 and <code>(wheels bike)</code> is 2, so this becomes</li>
</ul>
<div class="org-src-container">
<pre class="src src-glyph">sum <span style="color: #807f96;">&#10216;</span><span style="color: #cea2ca;">4</span> <span style="color: #cea2ca;">2</span><span style="color: #807f96;">&#10217;</span>
</pre>
</div>
<ul class="org-ul">
<li>Finally, we perform the <i>sum</i>, to get 6 - the total number of wheels on our
barge!</li>
</ul>
</div>
</div>

<div id="outline-container-orgac66eb7" class="outline-4">
<h4 id="orgac66eb7">Termination</h4>
<div class="outline-text-4" id="text-orgac66eb7">
<p>
You need to be careful when defining a recursive function:
we can make functions which never output a value! Take for example:
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>wheels : <span style="color: #d24b83;">Vehicle</span> &#8594; &#8469;<span style="color: #807f96;">)</span>          <span style="color: #545c5e;">;;</span>
<span style="color: #807f96;">(</span>wheels vehicle &#8796; <span style="color: #738FD7;">match</span> vehicle
  <span style="color: #9d81ba;">(</span>bike &#8594; wheels vehicle<span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>car &#8594; <span style="color: #cea2ca;">4</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>truck n &#8594; n<span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>barge cargo &#8594; sum <span style="color: #4d9391;">(</span>map wheels cargo<span style="color: #4d9391;">)</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
Now, imagine we want to know how many wheels a <code>bike</code> has, so we type <code>wheels
bike</code>. Substituting bike in for <i>vehicle</i>, we get:
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #738FD7;">match</span> bike
  <span style="color: #807f96;">(</span>bike &#8594; wheels bike<span style="color: #807f96;">)</span>
  <span style="color: #807f96;">(</span>car &#8594; <span style="color: #cea2ca;">4</span><span style="color: #807f96;">)</span>
  <span style="color: #807f96;">(</span>truck n &#8594; n<span style="color: #807f96;">)</span>
  <span style="color: #807f96;">(</span>barge cargo &#8594; sum <span style="color: #9d81ba;">(</span>map wheels cargo<span style="color: #9d81ba;">)</span>
</pre>
</div>

<p>
If we then do the pattern-match, this becomes 
</p>

<div class="org-src-container">
<pre class="src src-glyph">wheels bike
</pre>
</div>

<p>
Which is right back where we started! So, naturally, we have to apply the
wheels function to the value bike, getting:
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #738FD7;">match</span> bike
  <span style="color: #807f96;">(</span>bike &#8594; wheels bike<span style="color: #807f96;">)</span>
  <span style="color: #807f96;">(</span>car &#8594; <span style="color: #cea2ca;">4</span><span style="color: #807f96;">)</span>
  <span style="color: #807f96;">(</span>truck n &#8594; n<span style="color: #807f96;">)</span>
  <span style="color: #807f96;">(</span>barge cargo &#8594; sum <span style="color: #9d81ba;">(</span>map wheels cargo<span style="color: #9d81ba;">)</span>
</pre>
</div>

<p>
This then obviously reduces back to <code>wheels bike</code>, which then becomes&#x2026; well,
at this point, it should be obvious that we are never going to get a value. This
sort of bug can be surprisingly common (and annoying), so Glyph has a
termination-checker built-in, which will report an error if it thinks you have a
function that won't terminate. However, it does throw some false positives, so
you may wish to disable it by adding the line <code>;;* NO-TERMINATION-CHECK</code> above
your function, and Glyph will happily let it compile. Alternatively, there is a
way to set it per-project or per-file.
</p>
</div>
</div>
</div>


<div id="outline-container-org42046bb" class="outline-3">
<h3 id="org42046bb">Parametric Types</h3>
<div class="outline-text-3" id="text-org42046bb">
<p>
A common use-case for inductive types is to define various kinds of
containers. By far the simplest type of container is the <i>Maybe</i>. A maybe is
quite simple: it may or may not contain a single value. As an example, suppose
we want a type that might be a number:
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">induct</span> <span style="color: #d24b83;">Maybez</span>
  <span style="color: #9d81ba;">(</span>some : &#8484; &#8594; <span style="color: #d24b83;">Maybez</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>none : <span style="color: #d24b83;">Maybez</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
Maybes can be useful if we want to represent a function which might not be able
to produce a result that makes sense. As a simple example, imagine we want a
function that takes in a string like "2" and converts it into the corresponding
number, i.e. 2. As we can't convert "a" into a number, this might not be
possibly, so we represent such a function as to-int <code>String → Maybez</code>. 
</p>

<p>
The full definition of to-int is rather complicated so I'll make a restricted
version that can only recognize the numbers 0-9.  
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>to-int : <span style="color: #d24b83;">String</span> &#8594; <span style="color: #d24b83;">Maybez</span><span style="color: #807f96;">)</span>
<span style="color: #807f96;">(</span>to-int s &#8796; <span style="color: #738FD7;">match</span> s
  <span style="color: #9d81ba;">(</span><span style="color: #7CF083;">"0"</span> &#8594; some <span style="color: #cea2ca;">1</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span><span style="color: #7CF083;">"1"</span> &#8594; some <span style="color: #cea2ca;">1</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span><span style="color: #7CF083;">"2"</span> &#8594; some <span style="color: #cea2ca;">2</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span><span style="color: #7CF083;">"3"</span> &#8594; some <span style="color: #cea2ca;">3</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span><span style="color: #7CF083;">"4"</span> &#8594; some <span style="color: #cea2ca;">4</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span><span style="color: #7CF083;">"5"</span> &#8594; some <span style="color: #cea2ca;">5</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span><span style="color: #7CF083;">"6"</span> &#8594; some <span style="color: #cea2ca;">6</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span><span style="color: #7CF083;">"7"</span> &#8594; some <span style="color: #cea2ca;">7</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span><span style="color: #7CF083;">"8"</span> &#8594; some <span style="color: #cea2ca;">8</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span><span style="color: #7CF083;">"9"</span> &#8594; some <span style="color: #cea2ca;">9</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>_   &#8594; none<span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
Something this function uses is an underscore '_' pattern. This is the
wildcard pattern, and will match any value we give it. It is used to mean 
"I don't care what the value is".
</p>

<p>
Of course, there are many more types we might want to put in a Maybe - we might
want a <code>Maybe Bool</code> or a <code>Maybe String</code>. To do this, we give our inductive type
a <i>parameter</i>:
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">induct</span> <span style="color: #9d81ba;">(</span><span style="color: #d24b83;">Maybe A</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>none : <span style="color: #d24b83;">Maybe A</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>some : <span style="color: #d24b83;">A</span> &#8594; <span style="color: #d24b83;">Maybe A</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
So we can now make Maybes of all shapes and sizes, by replacing <code>A</code> with any
type we desire.
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>mb : <span style="color: #d24b83;">Maybe Bool</span><span style="color: #807f96;">)</span>
<span style="color: #807f96;">(</span>mb &#8796; some <span style="color: #cea2ca;">true</span><span style="color: #807f96;">)</span>

<span style="color: #807f96;">(</span>mn : <span style="color: #d24b83;">Maybe &#8469;</span><span style="color: #807f96;">)</span>
<span style="color: #807f96;">(</span>mn &#8796; none<span style="color: #807f96;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org1cfeb9c" class="outline-2">
<h2 id="org1cfeb9c">Coinductive Types</h2>
<div class="outline-text-2" id="text-org1cfeb9c">
</div>
<div id="outline-container-org6425f4d" class="outline-3">
<h3 id="org6425f4d">Introduction</h3>
<div class="outline-text-3" id="text-org6425f4d">
<p>
Coinductive types are like the 'opposite' of inductive types. To understand what
this means, first recall the inductive definition for our Vehicle type - 
each of the terms ('bike', 'car', etc.) provide a way of constructing a new
vehicle: <code>truck 2</code> will make a new truck, and <code>barge ⟨car bike⟩</code> will make a new
barge. By contrast, we define <i>coinductive</i> data by all the ways we can take it
apart or use it. 
</p>

<p>
So, what would a coinductive definition for vehicles look like? To answer this
question, we need to ask ourselves what we want to <i>do</i> with a vehicle. Earlier,
we defined a <code>wheels</code> function, which told us how many wheels our vehicle
had. At another point, we used a vehicle to print either "I have a bike" or "I
have a car". For now, lets' suppose these are the only two things we might
want to do with a vehicle. This can be converted into a coinductive type: 
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">coinduct</span> <span style="color: #d24b83;">Vehicle</span>
  <span style="color: #9d81ba;">(</span>wheels : <span style="color: #d24b83;">Vehicle</span> &#8594; &#8469;<span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>to-string : <span style="color: #d24b83;">Vehicle</span> &#8594; <span style="color: #d24b83;">String</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
This says "A vehicle is something which can tell us how many wheels it has, and
convert itself into a string". However, it doesn't tell us how to make a <i>new</i>
vehicle. To do this, we use the coinductive types' equivalent to pattern
matching: <code>covalue</code> construction. Let's define a bike and a car:
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>bike &#8796; <span style="color: #738FD7;">coval</span>
  <span style="color: #9d81ba;">(</span>wheels &#8594; <span style="color: #cea2ca;">2</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>to-string &#8594; <span style="color: #7CF083;">"bike"</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>car &#8796; <span style="color: #738FD7;">coval</span>
  <span style="color: #9d81ba;">(</span>wheels &#8594; <span style="color: #cea2ca;">4</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>to-string &#8594; <span style="color: #7CF083;">"car"</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
Using a vehicle is relatively easy: while we can't match, we are able to use any
of the functions that are guaranteed to exist:
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>my-vehicle &#8796; <span style="color: #738FD7;">coval</span>
  <span style="color: #9d81ba;">(</span>wheels &#8594; <span style="color: #cea2ca;">3</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>to-string &#8594; <span style="color: #7CF083;">"my trike"</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>

<span style="color: #807f96;">(</span>main : <span style="color: #d24b83;">IO</span> <span style="color: #9d81ba;">()</span><span style="color: #807f96;">)</span>
<span style="color: #807f96;">(</span>main &#8796; put-line <span style="color: #9d81ba;">(</span>to-string my-vehicle<span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
To replicate vehicles like <code>truck</code> and <code>barge</code> we can use functions, as shown below:
</p>


<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>truck : &#8469; &#8594; <span style="color: #d24b83;">Vehicle</span><span style="color: #807f96;">)</span>
<span style="color: #807f96;">(</span>truck n &#8796; comatch 
  <span style="color: #9d81ba;">(</span>wheels &#8594; n<span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>to-string &#8594; <span style="color: #7CF083;">"truck"</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>


<span style="color: #807f96;">(</span>barge : <span style="color: #d24b83;">Array Vehicle</span> &#8594; <span style="color: #d24b83;">Vehicle</span><span style="color: #807f96;">)</span>
<span style="color: #807f96;">(</span>barge cargo &#8796; comatch
  <span style="color: #9d81ba;">(</span>wheels &#8594; sum <span style="color: #4d9391;">(</span>map wheels cargo<span style="color: #4d9391;">)</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>to-string &#8594; <span style="color: #7CF083;">"barge containing "</span> &#8901; join-between _&#8901;_ <span style="color: #7CF083;">","</span> <span style="color: #4d9391;">(</span>map to-string cargo<span style="color: #4d9391;">)</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>
</div>

<div id="outline-container-org709256f" class="outline-4">
<h4 id="org709256f">Coinductive vs. Inductive Types</h4>
</div>
</div>

<div id="outline-container-org96618bf" class="outline-3">
<h3 id="org96618bf">Recursive Types and Infinite Codata</h3>
<div class="outline-text-3" id="text-org96618bf">
<p>
As with inductive types, coinductive types can be recursive. The simplest
demonstration of this is the coinductive list. 
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">coinduct</span> <span style="color: #9d81ba;">(</span><span style="color: #d24b83;">CoList</span> <span style="color: #4d9391;">(</span><span style="color: #d24b83;">A</span> : &#119984;<span style="color: #4d9391;">)</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>next : <span style="color: #d24b83;">CoList A</span> &#8594; <span style="color: #d24b83;">Maybe</span> <span style="color: #4d9391;">(</span><span style="color: #d24b83;">A</span> * <span style="color: #d24b83;">CoList A</span><span style="color: #4d9391;">)</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>


<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>count-from : &#8469; &#8594; <span style="color: #d24b83;">CoList &#8469;</span><span style="color: #807f96;">)</span>
<span style="color: #807f96;">(</span>count-from n &#8796; comatch
  <span style="color: #9d81ba;">(</span>next &#8594; some <span style="color: #4d9391;">(</span>n , count-from <span style="color: #a0586c;">(</span>n + <span style="color: #cea2ca;">1</span><span style="color: #a0586c;">)</span><span style="color: #4d9391;">)</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>
</div>


<div id="outline-container-org2a85f83" class="outline-4">
<h4 id="org2a85f83">Productivity</h4>
</div>
</div>


<div id="outline-container-org59804bb" class="outline-3">
<h3 id="org59804bb">Parametrized Codata: Streams</h3>
<div class="outline-text-3" id="text-org59804bb">
<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">coinduct</span> <span style="color: #9d81ba;">(</span><span style="color: #d24b83;">CoList</span> <span style="color: #4d9391;">[</span><span style="color: #d24b83;">A</span><span style="color: #4d9391;">]</span> : &#119984;<span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>head : <span style="color: #d24b83;">CoList A</span> &#8594; <span style="color: #d24b83;">Maybe A</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>tail : <span style="color: #d24b83;">CoList A</span> &#8594; <span style="color: #d24b83;">Maybe</span> <span style="color: #4d9391;">(</span><span style="color: #d24b83;">MyList A</span><span style="color: #4d9391;">)</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">defn</span> colen-bad
  ...<span style="color: #807f96;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span>colen : <span style="color: #9d81ba;">{</span><span style="color: #d24b83;">A</span><span style="color: #9d81ba;">}</span> &#8594; <span style="color: #d24b83;">CoList A</span> &#8594; <span style="color: #d24b83;">CoNat</span><span style="color: #807f96;">)</span>
<span style="color: #807f96;">(</span><span style="color: #738FD7;">defn</span> colen <span style="color: #9d81ba;">[</span>colist<span style="color: #9d81ba;">]</span>
  <span style="color: #9d81ba;">(</span><span style="color: #738FD7;">match</span> <span style="color: #4d9391;">(</span>tail colist<span style="color: #4d9391;">)</span> 
    <span style="color: #4d9391;">(</span><span style="color: #d24b83;">Just tl</span> &#8594; comatch
      <span style="color: #a0586c;">(</span>pred &#8594; <span style="color: #53859d;">(</span>len tl<span style="color: #53859d;">)</span><span style="color: #a0586c;">)</span><span style="color: #4d9391;">)</span>
    <span style="color: #4d9391;">(</span><span style="color: #d24b83;">Nothing</span> &#8594; comatch
      <span style="color: #a0586c;">(</span>pred &#8594; cozero<span style="color: #a0586c;">)</span><span style="color: #4d9391;">)</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">coinduct</span> <span style="color: #9d81ba;">(</span><span style="color: #d24b83;">Stream</span> <span style="color: #4d9391;">[</span><span style="color: #d24b83;">A</span><span style="color: #4d9391;">]</span> : &#119984;<span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>value : <span style="color: #d24b83;">Stream A</span> &#8594; <span style="color: #d24b83;">A</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>next : <span style="color: #d24b83;">Stream A</span> &#8594; <span style="color: #d24b83;">MyList A</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>
</div>
</div>
</div>



<div id="outline-container-orge44128e" class="outline-2">
<h2 id="orge44128e">Structures</h2>
<div class="outline-text-2" id="text-orge44128e">
<p>
Inductive and Coinductive datatypes are defined by functions: Inductively, we
specify functions to introduce new values, and coinductively we specify
functions which eliminate existing values. Structures, meanwhile, are defined as
a set of <i>names</i> and corresponding <i>values</i>. 
</p>

<p>
Signatures are for representing data with <i>named</i> subparts. A simple example,
might be a 2D point, which has an <code>x</code> and <code>y</code> coordinate. 
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">signature</span> <span style="color: #9d81ba;">(</span><span style="color: #d24b83;">Point</span> : &#119984;<span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>x : &#8484;<span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>x : &#8484;<span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
To create a value whose type is a signature, you need a structure:
</p>

<div class="org-src-container">
<pre class="src src-glyph"><span style="color: #807f96;">(</span><span style="color: #738FD7;">structure</span> <span style="color: #9d81ba;">(</span>my-point : <span style="color: #d24b83;">Point</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>x &#8796; <span style="color: #cea2ca;">2</span><span style="color: #9d81ba;">)</span>
  <span style="color: #9d81ba;">(</span>y &#8796; <span style="color: #cea2ca;">2</span><span style="color: #9d81ba;">)</span><span style="color: #807f96;">)</span>
</pre>
</div>

<p>
Structures and signatures, along with how they are (often) used. Will be
discussed in the next tutorial - <a href="abstraction.html">abstraction</a>.
</p>
</div>
</div>
</div>
</body>
</html>
